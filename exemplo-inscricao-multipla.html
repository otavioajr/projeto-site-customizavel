<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Exemplo - Sistema de Inscri√ß√£o M√∫ltipla</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }
    
    .container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      overflow: hidden;
    }
    
    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 30px;
      text-align: center;
    }
    
    .header h1 {
      font-size: 2rem;
      margin-bottom: 10px;
    }
    
    .header p {
      opacity: 0.9;
      font-size: 1.1rem;
    }
    
    .form-container {
      padding: 30px;
    }
    
    /* Seletor de Quantidade */
    .quantity-selector {
      background: #f8f9fa;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 30px;
      border: 2px solid #e9ecef;
    }
    
    .quantity-selector h2 {
      font-size: 1.2rem;
      color: #495057;
      margin-bottom: 15px;
    }
    
    .quantity-buttons {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    
    .quantity-btn {
      flex: 1;
      min-width: 60px;
      padding: 12px 20px;
      border: 2px solid #dee2e6;
      background: white;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      color: #495057;
    }
    
    .quantity-btn:hover {
      background: #f8f9fa;
      border-color: #667eea;
    }
    
    .quantity-btn.active {
      background: #667eea;
      color: white;
      border-color: #667eea;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }
    
    /* Status de Vagas */
    .availability-status {
      background: #d4edda;
      border: 1px solid #c3e6cb;
      border-radius: 8px;
      padding: 12px;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .availability-status.warning {
      background: #fff3cd;
      border-color: #ffeeba;
    }
    
    .availability-status.error {
      background: #f8d7da;
      border-color: #f5c6cb;
    }
    
    .availability-icon {
      font-size: 1.5rem;
    }
    
    .availability-text {
      flex: 1;
    }
    
    .availability-text strong {
      display: block;
      margin-bottom: 4px;
    }
    
    /* Se√ß√£o do Respons√°vel */
    .responsible-section {
      background: #f8f9fa;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
      border: 2px solid #667eea;
    }
    
    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    
    .section-header h3 {
      color: #667eea;
      font-size: 1.2rem;
    }
    
    .section-badge {
      background: #667eea;
      color: white;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 0.875rem;
    }
    
    /* Se√ß√µes de Participantes */
    .participant-section {
      background: white;
      border: 2px solid #e9ecef;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
      position: relative;
      transition: all 0.3s ease;
    }
    
    .participant-section:hover {
      border-color: #667eea;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    .participant-number {
      position: absolute;
      top: -12px;
      left: 20px;
      background: #667eea;
      color: white;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 0.875rem;
      font-weight: 600;
    }
    
    .remove-participant {
      position: absolute;
      top: 10px;
      right: 10px;
      background: #dc3545;
      color: white;
      border: none;
      border-radius: 50%;
      width: 30px;
      height: 30px;
      cursor: pointer;
      font-size: 1.2rem;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }
    
    .remove-participant:hover {
      background: #c82333;
      transform: rotate(90deg);
    }
    
    /* Campos do Formul√°rio */
    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
      margin-bottom: 15px;
    }
    
    .form-group {
      margin-bottom: 15px;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: 600;
      color: #495057;
      font-size: 0.9rem;
    }
    
    .form-group label .required {
      color: #dc3545;
    }
    
    .form-group input,
    .form-group select {
      width: 100%;
      padding: 10px 12px;
      border: 2px solid #e9ecef;
      border-radius: 8px;
      font-size: 1rem;
      transition: all 0.3s ease;
    }
    
    .form-group input:focus,
    .form-group select:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }
    
    /* Bot√µes de A√ß√£o */
    .action-buttons {
      display: flex;
      gap: 15px;
      margin-top: 30px;
    }
    
    .btn {
      padding: 14px 30px;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      flex: 2;
    }
    
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
    }
    
    .btn-secondary {
      background: white;
      color: #667eea;
      border: 2px solid #667eea;
      flex: 1;
    }
    
    .btn-secondary:hover {
      background: #f8f9fa;
    }
    
    .btn-add {
      background: #28a745;
      color: white;
    }
    
    .btn-add:hover {
      background: #218838;
    }
    
    /* Resumo da Inscri√ß√£o */
    .summary-section {
      background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
      border-radius: 12px;
      padding: 20px;
      margin-top: 30px;
    }
    
    .summary-section h3 {
      color: #495057;
      margin-bottom: 15px;
    }
    
    .summary-item {
      display: flex;
      justify-content: space-between;
      padding: 10px 0;
      border-bottom: 1px solid #dee2e6;
    }
    
    .summary-item:last-child {
      border-bottom: none;
      font-weight: 600;
      font-size: 1.1rem;
      color: #667eea;
    }
    
    /* Anima√ß√µes */
    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .participant-section {
      animation: slideIn 0.3s ease-out;
    }
    
    /* Responsive */
    @media (max-width: 768px) {
      .form-row {
        grid-template-columns: 1fr;
      }
      
      .quantity-buttons {
        flex-direction: column;
      }
      
      .action-buttons {
        flex-direction: column;
      }
      
      .btn {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üèîÔ∏è Inscri√ß√£o para Trilha do Pico</h1>
      <p class="subtitle">Sistema de Inscri√ß√£o M√∫ltipla - Exemplo Funcional</p>
      <div style="background: #e7f3ff; border: 2px solid #667eea; border-radius: 8px; padding: 15px; margin-top: 15px; font-size: 0.9rem;">
        <strong>üí° Dica:</strong> Os campos com <strong>"Participante"</strong> no nome repetem para cada pessoa. 
        Os campos com <strong>"Respons√°vel"</strong> aparecem apenas uma vez.
      </div>
    </div>
    
    <div class="form-container">
      <!-- Status de Vagas -->
      <div class="availability-status" id="availability-status">
        <span class="availability-icon">‚úÖ</span>
        <div class="availability-text">
          <strong>Vagas Dispon√≠veis</strong>
          <span id="availability-text">30 vagas restantes de 50 totais</span>
        </div>
      </div>
      
      <!-- Seletor de Quantidade -->
      <div class="quantity-selector">
        <h2>üìã Quantas pessoas voc√™ deseja inscrever?</h2>
        <div class="quantity-buttons">
          <button class="quantity-btn active" data-quantity="1">1 pessoa</button>
          <button class="quantity-btn" data-quantity="2">2 pessoas</button>
          <button class="quantity-btn" data-quantity="3">3 pessoas</button>
          <button class="quantity-btn" data-quantity="4">4 pessoas</button>
          <button class="quantity-btn" data-quantity="5">5 pessoas</button>
          <button class="quantity-btn" data-quantity="6">6+ pessoas</button>
        </div>
      </div>
      
      <form id="inscription-form">
        <!-- Dados do Respons√°vel -->
        <div class="responsible-section">
          <div class="section-header">
            <h3>üë§ Dados do Respons√°vel</h3>
            <span class="section-badge">Obrigat√≥rio</span>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label>Nome Completo <span class="required">*</span></label>
              <input type="text" name="responsible_name" required>
            </div>
            <div class="form-group">
              <label>CPF <span class="required">*</span></label>
              <input type="text" name="responsible_cpf" placeholder="000.000.000-00" required>
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label>Email <span class="required">*</span></label>
              <input type="email" name="responsible_email" required>
            </div>
            <div class="form-group">
              <label>Telefone <span class="required">*</span></label>
              <input type="tel" name="responsible_phone" placeholder="(00) 00000-0000" required>
            </div>
          </div>
          
          <div class="form-group">
            <label>Endere√ßo Completo <span class="required">*</span></label>
            <input type="text" name="responsible_address" required>
          </div>
        </div>
        
        <!-- Container para Participantes -->
        <div id="participants-container">
          <!-- Participantes ser√£o adicionados dinamicamente aqui -->
        </div>
        
        <!-- Bot√£o para adicionar mais participantes -->
        <button type="button" class="btn btn-add" id="add-participant" style="display: none;">
          + Adicionar Outro Participante
        </button>
        
        <!-- Resumo -->
        <div class="summary-section">
          <h3>üìä Resumo da Inscri√ß√£o</h3>
          <div class="summary-item">
            <span>N√∫mero de participantes:</span>
            <span id="summary-count">1</span>
          </div>
          <div class="summary-item">
            <span>Valor por pessoa:</span>
            <span>R$ 150,00</span>
          </div>
          <div class="summary-item">
            <span>Valor total:</span>
            <span id="summary-total">R$ 150,00</span>
          </div>
        </div>
        
        <!-- Bot√µes de A√ß√£o -->
        <div class="action-buttons">
          <button type="button" class="btn btn-secondary" onclick="resetForm()">
            Limpar Formul√°rio
          </button>
          <button type="submit" class="btn btn-primary">
            Confirmar Inscri√ß√£o
          </button>
        </div>
      </form>
    </div>
  </div>
  
  <script>
    // Estado global
    let participantCount = 1;
    const maxParticipants = 10;
    const pricePerPerson = 150;
    const totalAvailableSlots = 50;
    const usedSlots = 20; // Simulando vagas j√° ocupadas
    
    // Template para campos repet√≠veis
    const participantFieldsTemplate = (index) => `
      <div class="participant-section" data-participant="${index}">
        <span class="participant-number">Participante ${index}</span>
        ${index > 1 ? '<button type="button" class="remove-participant" onclick="removeParticipant(' + index + ')">√ó</button>' : ''}
        
        <div class="form-row">
          <div class="form-group">
            <label>Nome Completo <span class="required">*</span></label>
            <input type="text" name="participant_${index}_name" required>
          </div>
          <div class="form-group">
            <label>CPF <span class="required">*</span></label>
            <input type="text" name="participant_${index}_cpf" placeholder="000.000.000-00" required>
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label>Data de Nascimento <span class="required">*</span></label>
            <input type="date" name="participant_${index}_birth" required>
          </div>
          <div class="form-group">
            <label>Sexo <span class="required">*</span></label>
            <select name="participant_${index}_gender" required>
              <option value="">Selecione</option>
              <option value="M">Masculino</option>
              <option value="F">Feminino</option>
              <option value="O">Outro</option>
            </select>
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label>Contato de Emerg√™ncia <span class="required">*</span></label>
            <input type="text" name="participant_${index}_emergency_name" placeholder="Nome" required>
          </div>
          <div class="form-group">
            <label>Telefone Emerg√™ncia <span class="required">*</span></label>
            <input type="tel" name="participant_${index}_emergency_phone" placeholder="(00) 00000-0000" required>
          </div>
        </div>
        
        <div class="form-group">
          <label>Restri√ß√µes Alimentares ou Condi√ß√µes M√©dicas</label>
          <input type="text" name="participant_${index}_restrictions" placeholder="Opcional">
        </div>
      </div>
    `;
    
    // Inicializa√ß√£o
    document.addEventListener('DOMContentLoaded', () => {
      updateParticipants(1);
      updateAvailability();
      
      // Event listeners para bot√µes de quantidade
      document.querySelectorAll('.quantity-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          const quantity = parseInt(this.dataset.quantity);
          
          if (quantity === 6) {
            // Para 6+ pessoas, permitir adicionar dinamicamente
            updateParticipants(5);
            document.getElementById('add-participant').style.display = 'block';
          } else {
            updateParticipants(quantity);
            document.getElementById('add-participant').style.display = 'none';
          }
          
          // Atualizar bot√£o ativo
          document.querySelectorAll('.quantity-btn').forEach(b => b.classList.remove('active'));
          this.classList.add('active');
        });
      });
      
      // Adicionar participante
      document.getElementById('add-participant').addEventListener('click', () => {
        if (participantCount < maxParticipants) {
          addParticipant();
        } else {
          alert(`Limite m√°ximo de ${maxParticipants} participantes atingido!`);
        }
      });
      
      // Submit do formul√°rio
      document.getElementById('inscription-form').addEventListener('submit', handleSubmit);
    });
    
    // Fun√ß√µes
    function updateParticipants(count) {
      const container = document.getElementById('participants-container');
      const currentParticipants = container.querySelectorAll('.participant-section').length;
      
      // Verificar disponibilidade
      const availableSlots = totalAvailableSlots - usedSlots;
      if (count > availableSlots) {
        alert(`Apenas ${availableSlots} vagas dispon√≠veis!`);
        return;
      }
      
      // Adicionar participantes se necess√°rio
      if (count > currentParticipants) {
        for (let i = currentParticipants + 1; i <= count; i++) {
          const participantHtml = participantFieldsTemplate(i);
          container.insertAdjacentHTML('beforeend', participantHtml);
        }
      }
      
      // Remover participantes se necess√°rio
      if (count < currentParticipants) {
        const toRemove = container.querySelectorAll('.participant-section:nth-child(n+' + (count + 1) + ')');
        toRemove.forEach(el => el.remove());
      }
      
      participantCount = count;
      updateSummary();
      updateAvailability();
    }
    
    function addParticipant() {
      participantCount++;
      const container = document.getElementById('participants-container');
      container.insertAdjacentHTML('beforeend', participantFieldsTemplate(participantCount));
      updateSummary();
      updateAvailability();
    }
    
    function removeParticipant(index) {
      const participant = document.querySelector(`[data-participant="${index}"]`);
      if (participant) {
        participant.remove();
        participantCount--;
        
        // Renumerar participantes restantes
        renumberParticipants();
        updateSummary();
        updateAvailability();
      }
    }
    
    function renumberParticipants() {
      const participants = document.querySelectorAll('.participant-section');
      participants.forEach((el, index) => {
        const newIndex = index + 1;
        el.dataset.participant = newIndex;
        el.querySelector('.participant-number').textContent = `Participante ${newIndex}`;
        
        // Atualizar nomes dos campos
        el.querySelectorAll('input, select').forEach(field => {
          field.name = field.name.replace(/participant_\d+/, `participant_${newIndex}`);
        });
        
        // Atualizar bot√£o de remover
        const removeBtn = el.querySelector('.remove-participant');
        if (removeBtn && newIndex > 1) {
          removeBtn.setAttribute('onclick', `removeParticipant(${newIndex})`);
        }
      });
      
      participantCount = participants.length;
    }
    
    function updateSummary() {
      document.getElementById('summary-count').textContent = participantCount;
      document.getElementById('summary-total').textContent = `R$ ${(participantCount * pricePerPerson).toFixed(2).replace('.', ',')}`;
    }
    
    function updateAvailability() {
      const availableSlots = totalAvailableSlots - usedSlots;
      const statusEl = document.getElementById('availability-status');
      const textEl = document.getElementById('availability-text');
      
      if (participantCount > availableSlots) {
        statusEl.className = 'availability-status error';
        statusEl.querySelector('.availability-icon').textContent = '‚ùå';
        textEl.textContent = `N√£o h√° vagas suficientes! Apenas ${availableSlots} dispon√≠veis.`;
      } else if (availableSlots - participantCount <= 5) {
        statusEl.className = 'availability-status warning';
        statusEl.querySelector('.availability-icon').textContent = '‚ö†Ô∏è';
        textEl.textContent = `√öltimas vagas! Apenas ${availableSlots} restantes de ${totalAvailableSlots} totais.`;
      } else {
        statusEl.className = 'availability-status';
        statusEl.querySelector('.availability-icon').textContent = '‚úÖ';
        textEl.textContent = `${availableSlots} vagas restantes de ${totalAvailableSlots} totais`;
      }
    }
    
    function resetForm() {
      if (confirm('Deseja limpar todos os campos do formul√°rio?')) {
        document.getElementById('inscription-form').reset();
        updateParticipants(1);
        document.querySelectorAll('.quantity-btn').forEach(b => b.classList.remove('active'));
        document.querySelector('.quantity-btn[data-quantity="1"]').classList.add('active');
      }
    }
    
    function handleSubmit(e) {
      e.preventDefault();
      
      // Coletar dados
      const formData = new FormData(e.target);
      const data = {
        responsible: {},
        participants: [],
        totalParticipants: participantCount,
        totalValue: participantCount * pricePerPerson
      };
      
      // Processar dados do respons√°vel
      for (let [key, value] of formData.entries()) {
        if (key.startsWith('responsible_')) {
          data.responsible[key.replace('responsible_', '')] = value;
        } else if (key.includes('participant_')) {
          const match = key.match(/participant_(\d+)_(.+)/);
          if (match) {
            const index = parseInt(match[1]) - 1;
            const field = match[2];
            
            if (!data.participants[index]) {
              data.participants[index] = {};
            }
            data.participants[index][field] = value;
          }
        }
      }
      
      // Simular envio
      console.log('Dados da inscri√ß√£o:', data);
      
      // Mostrar confirma√ß√£o
      alert(`
        ‚úÖ Inscri√ß√£o realizada com sucesso!
        
        Respons√°vel: ${data.responsible.name}
        Participantes: ${participantCount}
        Valor Total: R$ ${data.totalValue.toFixed(2).replace('.', ',')}
        
        Um email de confirma√ß√£o ser√° enviado para ${data.responsible.email}
      `);
      
      // Aqui voc√™ faria a chamada para o backend
      // saveMultipleInscriptions(pageSlug, data);
    }
    
    // M√°scaras de input (simplificadas)
    document.addEventListener('input', function(e) {
      if (e.target.name && e.target.name.includes('cpf')) {
        let value = e.target.value.replace(/\D/g, '');
        if (value.length > 11) value = value.slice(0, 11);
        
        if (value.length > 9) {
          value = value.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4');
        } else if (value.length > 6) {
          value = value.replace(/(\d{3})(\d{3})(\d{3})/, '$1.$2.$3');
        } else if (value.length > 3) {
          value = value.replace(/(\d{3})(\d{3})/, '$1.$2');
        }
        
        e.target.value = value;
      }
      
      if (e.target.name && e.target.name.includes('phone')) {
        let value = e.target.value.replace(/\D/g, '');
        if (value.length > 11) value = value.slice(0, 11);
        
        if (value.length > 6) {
          value = value.replace(/(\d{2})(\d{5})(\d{4})/, '($1) $2-$3');
        } else if (value.length > 2) {
          value = value.replace(/(\d{2})(\d)/, '($1) $2');
        }
        
        e.target.value = value;
      }
    });
  </script>
</body>
</html>
